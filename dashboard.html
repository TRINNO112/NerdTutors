<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Economics Test Platform</title>

    <!-- Dashboard Styles -->
    <link rel="stylesheet" href="dashboard.css">

    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- ==================== SIDEBAR ==================== -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h1>ğŸ“Š Admin Dashboard</h1>
        </div>
        <nav class="nav-menu">
            <a href="#dashboard" class="nav-item active">
                <span class="nav-icon">ğŸ </span>
                <span>Dashboard</span>
            </a>
            <a href="#students" class="nav-item">
                <span class="nav-icon">ğŸ‘¥</span>
                <span>Students</span>
            </a>
            <a href="#results" class="nav-item">
                <span class="nav-icon">ğŸ“</span>
                <span>Test Results</span>
            </a>
            <a href="#analytics" class="nav-item">
                <span class="nav-icon">ğŸ“ˆ</span>
                <span>Analytics</span>
            </a>
            <a href="#export" class="nav-item">
                <span class="nav-icon">ğŸ’¾</span>
                <span>Export Data</span>
            </a>
            <a href="index.html" class="nav-item">
                <span class="nav-icon">ğŸ </span>
                <span>Back to Home</span>
            </a>
        </nav>
    </aside>

    <!-- ==================== MOBILE OVERLAY ==================== -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>

    <!-- ==================== MAIN CONTENT ==================== -->
    <div class="main-content">
        <!-- ==================== HEADER ==================== -->
        <header class="header">
            <div class="header-content">
                <button class="mobile-menu-btn" id="mobileMenuBtn"><span id="menuIcon">â˜°</span></button>
                <h2 class="page-title">Economics Test Dashboard</h2>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="refreshBtn">
                        ğŸ”„ Refresh
                    </button>
                    <button class="btn btn-primary" id="exportBtn">
                        ğŸ“¥ Export CSV
                    </button>
                </div>
            </div>
        </header>

        <!-- ==================== LOADING STATE ==================== -->
        <div id="loadingState" style="display: none;">
            <div class="content-section">
                <div class="loading-spinner"></div>
                <div class="loading-text">Loading dashboard data...</div>
            </div>
        </div>

        <!-- ==================== DASHBOARD CONTENT ==================== -->
        <div id="dashboardContent">

            <!-- ==================== DASHBOARD PAGE ==================== -->
            <div class="page-section active" id="dashboardPage">
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-header">
                            <span class="stat-icon">ğŸ‘¥</span>
                        </div>
                        <div class="stat-value" id="totalStudents">0</div>
                        <div class="stat-label">Total Students</div>
                        <div class="stat-trend trend-up" id="studentsTrend">
                            â†‘ <span>0</span> this week
                        </div>
                    </div>

                    <div class="stat-card success">
                        <div class="stat-header">
                            <span class="stat-icon">ğŸ“</span>
                        </div>
                        <div class="stat-value" id="totalTests">0</div>
                        <div class="stat-label">Tests Submitted</div>
                        <div class="stat-trend trend-up" id="testsTrend">
                            â†‘ <span>0</span> today
                        </div>
                    </div>

                    <div class="stat-card warning">
                        <div class="stat-header">
                            <span class="stat-icon">ğŸ“Š</span>
                        </div>
                        <div class="stat-value" id="avgScore">0%</div>
                        <div class="stat-label">Average Score</div>
                        <div class="stat-trend trend-up" id="scoreTrend">
                            â†‘ <span>0%</span> improvement
                        </div>
                    </div>

                    <div class="stat-card danger">
                        <div class="stat-header">
                            <span class="stat-icon">â±ï¸</span>
                        </div>
                        <div class="stat-value" id="recentActivity">0</div>
                        <div class="stat-label">Active Today</div>
                    </div>
                </div>

                <!-- Recent Results Preview -->
                <div class="content-section">
                    <div class="section-header">
                        <h3 class="section-title">ğŸ“‹ Recent Test Results</h3>
                        <button class="btn btn-secondary" id="viewAllBtn">View All â†’</button>
                    </div>
                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Student Name</th>
                                    <th>Date</th>
                                    <th>Score</th>
                                    <th>Type</th>
                                </tr>
                            </thead>
                            <tbody id="recentResultsBody">
                                <!-- Recent results will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ==================== STUDENTS PAGE ==================== -->
            <div class="page-section" id="studentsPage" style="display: none;">
                <div class="content-section">
                    <div class="section-header">
                        <h3 class="section-title">ğŸ‘¥ Student Management</h3>
                    </div>

                    <div class="filters-bar">
                        <div class="search-box">
                            <span class="search-icon">ğŸ”</span>
                            <input type="text" class="search-input" id="studentSearchInput"
                                placeholder="Search students...">
                        </div>
                        <select class="filter-select" id="studentSortFilter">
                            <option value="name">Sort by Name</option>
                            <option value="tests">Sort by Tests Taken</option>
                            <option value="score">Sort by Avg Score</option>
                            <option value="recent">Sort by Recent Activity</option>
                        </select>
                    </div>

                    <div class="students-grid" id="studentsGrid">
                        <!-- Student cards will be populated here -->
                    </div>
                </div>
            </div>

            <!-- ==================== RESULTS PAGE ==================== -->
            <div class="page-section" id="resultsPage" style="display: none;">
                <div class="content-section">
                    <div class="section-header">
                        <h3 class="section-title">ğŸ“ All Test Results</h3>
                    </div>

                    <div class="filters-bar">
                        <div class="search-box">
                            <span class="search-icon">ğŸ”</span>
                            <input type="text" class="search-input" id="searchInput"
                                placeholder="Search by student name...">
                        </div>

                        <select class="filter-select" id="testTypeFilter">
                            <option value="all">All Types</option>
                            <option value="mcq">MCQ Only</option>
                            <option value="text">Text Only</option>
                        </select>

                        <select class="filter-select" id="scoreFilter">
                            <option value="all">All Scores</option>
                            <option value="high">High (80%+)</option>
                            <option value="medium">Medium (50-79%)</option>
                            <option value="low">Low (&lt;50%)</option>
                        </select>

                        <select class="filter-select" id="dateFilter">
                            <option value="all">All Time</option>
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                        </select>
                    </div>

                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th class="sortable" data-sort="name">Student Name â†•</th>
                                    <th>Student ID</th>
                                    <th class="sortable" data-sort="date">Date â†•</th>
                                    <th>Type</th>
                                    <th class="sortable" data-sort="score">Score â†•</th>
                                    <th>Percentage</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="resultsTableBody">
                                <!-- Table rows will be populated here -->
                            </tbody>
                        </table>

                        <div class="empty-state" id="emptyState" style="display: none;">
                            <div class="empty-icon">ğŸ“­</div>
                            <div class="empty-title">No Results Found</div>
                            <p>No test results match your filters.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==================== ANALYTICS PAGE ==================== -->
            <div class="page-section" id="analyticsPage" style="display: none;">
                <div class="content-section">
                    <div class="section-header">
                        <h3 class="section-title">ğŸ“ˆ Analytics & Insights</h3>
                    </div>

                    <!-- Analytics Stats -->
                    <div class="analytics-stats" id="analyticsStats">
                        <div class="analytics-card">
                            <h4>ğŸ“Š Score Distribution</h4>
                            <div class="chart-wrapper" style="height: 250px;">
                                <canvas id="scoreDistributionChart"></canvas>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h4>ğŸ“… Tests Per Day (Last 7 Days)</h4>
                            <div class="chart-wrapper" style="height: 250px;">
                                <canvas id="testsPerDayChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Category Breakdown -->
                    <div class="analytics-table">
                        <h4>ğŸ“š Performance by Test Type</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Test Type</th>
                                    <th>Total Tests</th>
                                    <th>Avg Score</th>
                                    <th>Highest Score</th>
                                    <th>Lowest Score</th>
                                </tr>
                            </thead>
                            <tbody id="typeBreakdownBody">
                                <!-- Type breakdown will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ==================== EXPORT PAGE ==================== -->
            <div class="page-section" id="exportPage" style="display: none;">
                <div class="content-section">
                    <div class="section-header">
                        <h3 class="section-title">ğŸ’¾ Export Data</h3>
                    </div>

                    <div class="export-options">
                        <div class="export-card" id="exportAllResults">
                            <div class="export-icon">ğŸ“Š</div>
                            <h4>Export All Test Results</h4>
                            <p>Download all test results including student names, scores, and dates.</p>
                            <button class="btn btn-primary">ğŸ“¥ Download CSV</button>
                        </div>

                        <div class="export-card" id="exportStudentList">
                            <div class="export-icon">ğŸ‘¥</div>
                            <h4>Export Student List</h4>
                            <p>Download a list of all students with their average scores and test counts.</p>
                            <button class="btn btn-primary">ğŸ“¥ Download CSV</button>
                        </div>

                        <div class="export-card" id="exportMCQResults">
                            <div class="export-icon">âœ…</div>
                            <h4>Export MCQ Results Only</h4>
                            <p>Download only MCQ test results with answer details.</p>
                            <button class="btn btn-primary">ğŸ“¥ Download CSV</button>
                        </div>

                        <div class="export-card" id="exportTextResults">
                            <div class="export-icon">ğŸ“</div>
                            <h4>Export Text Results Only</h4>
                            <p>Download only text-based test results with feedback.</p>
                            <button class="btn btn-primary">ğŸ“¥ Download CSV</button>
                        </div>

                        <div class="export-card" id="exportAnalytics">
                            <div class="export-icon">ğŸ“ˆ</div>
                            <h4>Export Analytics Report</h4>
                            <p>Download a summary report with statistics and insights.</p>
                            <button class="btn btn-primary">ğŸ“¥ Download CSV</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    </div>

    <!-- ==================== STUDENT DETAIL MODAL ==================== -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Student Test Details</h3>
                <button class="modal-close" id="closeModal">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="detail-section">
                    <div class="detail-label">Student Information</div>
                    <div class="detail-value" id="modalStudentName">-</div>
                    <div class="detail-value" style="font-size: 0.9rem; color: #64748b;" id="modalStudentId">-</div>
                </div>

                <div class="detail-section">
                    <div class="detail-label">Test Results</div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                        <div>
                            <div class="detail-label">Score</div>
                            <div class="detail-value" id="modalScore">-</div>
                        </div>
                        <div>
                            <div class="detail-label">Percentage</div>
                            <div class="detail-value" id="modalPercentage">-</div>
                        </div>
                        <div>
                            <div class="detail-label">Date</div>
                            <div class="detail-value" id="modalDate">-</div>
                        </div>
                    </div>
                </div>

                <div class="detail-section">
                    <div class="detail-label">Question-wise Performance</div>
                    <div class="answers-list" id="modalAnswersList">
                        <!-- Answers will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== FIREBASE & APP SCRIPTS ==================== -->
    <script type="module" src="dashboard.js"></script>
</body>

</html>